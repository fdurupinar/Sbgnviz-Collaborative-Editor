<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl">
  <title data-ice="title">Home | Sbgnviz-Collaborative-Editor</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#js">js</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/collaborative-app/js/modelManager.js~ModelManager.html">ModelManager</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-clientSideSocketListener">clientSideSocketListener</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#js-merger">js/merger</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/collaborative-app/js/merger/json-merger.js~JsonMerger.html">JsonMerger</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/collaborative-app/js/merger/rephrase-handler.js~RephraseHandler.html">RephraseHandler</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-modelmergefunctions">modelmergefunctions</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#js-newt-functions">js/newt-functions</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-editorlistener">editorlistener</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PathsBetweenQueryView">PathsBetweenQueryView</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PathsByURIQueryView">PathsByURIQueryView</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#js-oncoprint">js/oncoprint</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/collaborative-app/js/oncoprint/oncoprint-handler.js~OncoprintHandler.html">OncoprintHandler</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#js-reach-functions">js/reach-functions</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-idxCardinfo">idxCardinfo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-idxCardToJson">idxCardToJson</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#js-visual-manipulation">js/visual-manipulation</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/collaborative-app/js/visual-manipulation/vis-handler.js~VisHandler.html">VisHandler</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><div data-ice="index" class="github-markdown"><h1 id="sbgnviz-collaborative-editor-user-guide">SBGNViz Collaborative Editor User Guide</h1><p>The editor allows human curators and computer agents to work on the same
pathway model, and communicate through text and images. On the server
side, we have an application server that keeps the model, handles
communication across clients, and performs operational transformation.
Model visualization and editing are handled on the client side. The
editor visualizes information about cellular processes and pathways in
SBGN (Systems Biology Graphical Notation) format. It allows for
automatic graph layout, editing and highlighting facilities.</p>
<h2 id="installation">Installation</h2><h3 id="install-dependencies-on-debian-ubuntu">Install dependencies on Debian/Ubuntu</h3><p>Install node.js and mongodb servers first.</p>
<p>Node:</p>
<pre><code><code class="source-code prettyprint">curl -sL https://deb.nodesource.com/setup_0.12 | sudo -E bash - &lt;br /&gt;
sudo apt-get install -y nodejs &lt;br /&gt;</code>
</code></pre><p>Mongo:</p>
<pre><code><code class="source-code prettyprint">sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com/ --recv EA312927 &lt;br /&gt;
echo &quot;deb http://repo.mongodb.org/apt/ubuntu trusty/mongodb-org/3.2 multiverse&quot; | sudo tee /etc/apt/sources.list.d/mongodb-org-3.2.list &lt;br /&gt;
sudo apt-get update &lt;br /&gt;
sudo apt-get install -y mongodb-org &lt;br /&gt;</code>
</code></pre><p>If mongo does not work:</p>
<pre><code><code class="source-code prettyprint">sudo apt-get install upstart-sysv</code>
</code></pre><h3 id="install-dependencies-on-mac">Install dependencies on Mac</h3><pre><code><code class="source-code prettyprint">brew install node
brew install tcl-tk
brew install mongodb
brew install nodejs</code>
</code></pre><h3 id="clone-from-github-and-install-node-modules">Clone from github and install node modules</h3><pre><code><code class="source-code prettyprint">https://github.com/fdurupinar/Sbgnviz-Collaborative-Editor.git
cd Sbgnviz-Collaborative-Editor
npm install</code>
</code></pre><h2 id="running-the-server">Running the server</h2><p>With Bob:</p>
<pre><code><code class="source-code prettyprint">node server</code>
</code></pre><p>Without Bob:</p>
<pre><code><code class="source-code prettyprint">node server -notrips
</code>
</code></pre><p>In order to open a client enter <code>http://localhost:3000</code> in the address bar of your browser.</p>
<h2 id="computer-agent-api">Computer Agent API</h2><p>Computer agents are connected to the node.js http server via websockets
(socket.io.js). An agent is initialized with a <em>name (string)</em> and a
unique <em>ID (string).</em></p>
<p><strong>Constructor</strong>: Agent (string name, string id)</p>
<h3 id="public-attributes-">Public Attributes:</h3><ul>
<li><strong>agentId</strong>: (string) A unique id</li>
<li><strong>agentName</strong>: (string) Agent name</li>
<li><strong>colorCode</strong>: A specific color to identify the agent operations. It
should be a string in hsla format as: &#x201C;hsla(<em>H</em>, <em>S</em>, <em>L</em>%, 1)&#x201D;, where
<em>H (integer)</em>, <em>S (float)</em> and <em>L (float)</em> are hue, saturation and
lightness values.</li>
<li><strong>selectedNode</strong>: The node object on which the agent is performing
operations. It has attributes such as position
{x:&lt; posX &gt;,y:&lt; posY &gt;}, width, height, borderWidth,
borderHeight, backgroundColor, sbgnLabel, sbgnStatesAndInfos =
{clazz:&lt; className &gt;, state =
{value:&lt; stateValue &gt;,variable:&lt; stateVariable &gt;}}.</li>
<li><strong>selectedEdge</strong>: The edge object on which the agent is performing
operations. It has attributes such as cardinality, lineColor and width.</li>
<li><strong>opHistory</strong>: History of operations as an array of strings in the
format: &#x201C;<em>UserName</em> (<em>date</em>): <em>Command</em>&#x201D;.</li>
<li><strong>chatHistory</strong>: Chat history as an array of messages.</li>
<li><strong>userList</strong>: List of connected user ids.</li>
</ul>
<h3 id="private-attributes-">Private Attributes:</h3><ul>
<li><strong>room</strong>: The document id that identifies the shared model. It is the
string after http:&lt;ip&gt;:3000/ in the server address.</li>
<li><strong>socket</strong>: The web socket between the server and agent</li>
<li><strong>pageDoc</strong>: The document that the shared model is stored.</li>
</ul>
<h4 id="requests-to-send-to-the-server-">Requests to send to the server:</h4><p> <strong>reqName</strong>                          |  <strong>param</strong>                                                                         |
| ----------------------------------- | ---------------------------------------------------- |
| &#x201C;agentSendImageRequest&#x201D;              | {room:&lt; room &gt;, userId:&lt; agentId &gt;, img: &lt; image file &gt;,                         |
|                                     | fileName &lt; name of image file &gt;, tabIndex: &lt; index or id of the tab to display image &gt;, tabLabel:&lt; Label of tab to be displayed &gt;}             |
| &quot;agentSetLayoutPropertiesRequest&quot;   | {room:&lt; room &gt;, userId:&lt; agentId &gt;,name: &lt; layout name &gt;,                       |
|                                     | nodeRepulsion: &lt; node repulsion value &gt; ,        |
|                                     | nodeOverlap:&lt; node overlap percentage &gt;,          |
|                                     | idealEdgeLength:&lt; ideal edge length value &gt;,      |
|                                     | edgeElasticity:&lt; edge elasticity value &gt;,    |
|                                     | nestingFactor:&lt; nesting factor value &gt;,      |
|                                     | gravity:&lt; gravity value &gt;,   |
|                                     | numIter:&lt; number of iterations &gt;,|
|                                     | tile:&lt; boolean value to tile disconnected &gt;,|
|                                     | animate:&lt; boolean value &gt;,    |
|                                     | randomize:&lt; boolean value &gt;}  |
|&quot;agentSetGeneralPropertiesRequest&quot;  | {room:&lt; room &gt;, userId:&lt; agentId &gt;} |
|&quot;agentSetGridPropertiesRequest&quot;  | {room:&lt; room &gt;, userId:&lt; agentId &gt;} |
|  &#x201C;agentRunLayoutRequest&#x201D;            | {room:&lt; room &gt;, userId:&lt; agentId &gt;}                          |
|  &#x201C;agentAddNodeRequest&#x201D;              | {room:&lt; room &gt;, userId:&lt; agentId &gt;,{{position: x: &lt; position x &gt;,           |
|                                     | y: &lt; position y &gt;}, data:{         |
|                                     | class: &lt; sbgn class &gt;}}   |
|  &#x201C;agentAddEdgeRequest&#x201D;              | {room:&lt; room &gt;, userId:&lt; agentId &gt;, {data:{source: &lt; source node id &gt;,  |
|                                     | target: &lt; target node id &gt;,   |
|                                     | class: &lt; sbgn class &gt;}}}    |
|&quot;agentSearchByLabelRequest&quot;          | {room:&lt; room &gt;, userId:&lt; agentId &gt;,label: &lt; label to be highlighted&gt;}   |
|&quot;agentDeleteElesRequest&quot;             | {room:&lt; room &gt;, userId:&lt; agentId &gt;,type: &lt; &quot;smart&quot; or &quot;simple&quot; &gt; elementIds: &lt; element ids to delete simply &gt;} |
|&quot;agentUpdateVisibilityStatusRequest&quot;       | {room:&lt; room &gt;, userId:&lt; agentId &gt;,val:&lt; &quot;hide&quot; or &quot;show&quot; or &quot;showAll&quot; &gt;,  elementIds:&lt; array of element ids or null for showAll &gt;|
|&quot;agentUpdateHighlightStatusRequest&quot;       | {room:&lt; room &gt;, userId:&lt; agentId &gt;,val:&lt; &quot;neighbors&quot; or &quot;processes&quot; or &quot;remove&quot;&gt;,  elementIds:&lt; array of element ids or null for remove &gt;|
|&quot;agentUpdateExpandCollapseStatusRequest&quot;       | {room:&lt; room &gt;, userId:&lt; agentId &gt;,val:&lt; &quot;expand&quot; or &quot;collapse&quot; &gt;,  elementIds:&lt;array of element ids&gt;|
| &#x201C;agentChangeNodeAttributeRequest&#x201D;  | {room:&lt; room &gt;, userId:&lt; agentId &gt;,id: &lt; node id &gt;,             |
|                                     | attStr: &lt; node attribute name in the model &gt;             |
|                                     | attVal:&lt; node attribute value &gt;}                          |
|                                     | attStr takes the following values: &#x201C;data&#x201D;, &#x201C;data.bbox&#x201D;, &#x201C;data.bbox.w&#x201D;, &#x201C;data.bbox.h&#x201D;, &#x201C;data.class&#x201D;, &#x201C;data.cloneMarker&#x201D;, &quot;data.font-family&quot;, &quot;data.font-size&quot;, &quot;data.font-weight&quot;, &quot;data.font-style&quot;, &quot;data.statesandinfos&quot;, &quot;data.label&quot;, &quot;data.labelsize&quot;, &quot;data.parent&quot;, &quot;data.ports&quot;, &quot;data.border-width&quot;, &quot;data.background-color&quot;, &quot;data.background-opacity&quot;, &quot;highlightColor, expandCollapseStatus&quot;, &quot;highlightStatus&quot;, &quot;visibilityStatus&quot;   |
|  &#x201C;agentChangeEdgeAttributeRequest&#x201D;  | {room:&lt; room &gt;, userId:&lt; agentId &gt;,id: &lt; node id &gt;,                                   |
|                                     | attStr: &lt; edge attribute name in the model &gt;        |
|                                     | attVal:&lt; edge attribute value &gt;}                     |
|                                     | attStr takes the following values: &#x201C;data.source&#x201D;, &#x201C;data.target&#x201D;, &#x201C;data.portsource&#x201D;, &#x201C;data.porttarget&#x201D;, &#x201C;data.class&#x201D;,   &#x201C;data.line-color&#x201D;,  &#x201C;data.width&#x201D;, &#x201C;data.cardinality&#x201D;,&#x201C;highlightColor&#x201D;, &quot;visibilityStatus&quot;, &quot;highlightStatus&quot; , &quot;bendPoints&quot;   |
|  &#x201C;agentMoveNodeRequest&#x201D;             | {room:&lt; room &gt;, userId:&lt; agentId &gt;,id: &lt; node id &gt;,   pos: {x:&lt; new position x &gt;, y: &lt;  new position y &gt;}}                   |
|  &#x201C;agentAlignRequest&#x201D;               | {room:&lt; room &gt;, userId:&lt; agentId &gt;,nodeIds: &lt; node ids to align &gt;, horizontal:&lt;&quot; top&quot;, &quot;bottom&quot;, &quot;center&quot;, &quot;none&quot; &gt;, vertical:&lt; &quot;top&quot;, &quot;bottom&quot;, &quot;center&quot;, &quot;none&quot; &gt; , alignTo:&lt; node id to align nodes with nodeIds &gt;     |
|  &#x201C;agentAddCompoundRequest&#x201D;          | {room:&lt; room &gt;, userId:&lt; agentId &gt;,type: &lt; compound type as &#x201C;complex&#x201D; or &#x201C;compartment&#x201D; &gt;,              |
|                                     | selectedNodeArr: &lt; array of node ids &gt;}                              |
|        &quot;agentActiveRoomsRequest&quot;                    | {room:&lt; room &gt;, userId:&lt; agentId &gt;}                                                                                                                                            |
|   &quot;agentUndoRequest&quot;          |  {room:&lt; room &gt;, userId:&lt; agentId &gt;} |
|   &quot;agentRedoRequest&quot;          |   {room:&lt; room &gt;, userId:&lt; agentId &gt;}|
|   &quot;agentMessage&quot;          |{ room: &lt; room &gt;, userId: &lt; agentId &gt;, comment:  &lt; message string -- can be raw html&gt;, targets: &lt; user ids or * to include all users in the room &gt;}   |
|   &quot;agentMergeGraphRequest&quot;          |{ room: &lt; room &gt;, userId: &lt; agentId &gt;, graph: &lt;graph content &gt;, type: &lt; &quot;sbgn&quot; or &quot;json&quot; &gt;, cyId: &lt; tab id | 0 if not specified &gt; }   |
|   &quot;agentDisplaySbgnRequest&quot;          |{ room: &lt; room &gt;, userId: &lt; agentId &gt;, sbgn: &lt; sbgn content &gt;, cyId: &lt; tab id or 0 if not specified &gt; }   |
|   &quot;agentDisplaySifRequest&quot;          |{ room: &lt; room &gt;, userId: &lt; agentId &gt;, sif: &lt; sif content &gt;, cyId: &lt; tab id or 0 if not specified &gt; }   |
|   &quot;agentAddProvenanceRequest&quot;          | { room: &lt; room &gt;, userId: &lt; agentId &gt;, html:&lt; html content &gt;, cyId: &lt; tab id or 0 if not specified &gt;, title:&lt; optional &gt;, pc:&lt; optional, Pathway Commons links &gt; }   |
|   &quot;agentRemoveBobRequest&quot;          | { room:&lt; room &gt;, userId:&lt; agentId &gt; } , Disconnects Trips agent |
|   &quot;agentUpdateSampleSentencesRequest&quot;          | { json: &lt;json file for sample sentences. Sample format can be found at: /server/data/sampleSentences.json&gt;room:&lt; room &gt;, userId:&lt; agentId &gt; }|</p>
<p>In order to set up and run an agent:</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">agent = new Agent(agentName, agentId);
    var socket = agent.connectToServer(serverIp, function(){
        //callback operations


    agent.loadModel(function() {
        agent.loadOperationHistory(function(){
            agent.loadChatHistory(function(){
                //callback operations
            });
        });
    });

    agent.listen(function(){
        socket.on(&apos;operation&apos;, function(data){
            //callback operations
        });

        socket.on(&apos;message&apos;, function(data){
            //callback operations
        });

        socket.on(&apos;userList&apos;, function(data){
            //callback operations
        });

        socket.on(&apos;imageFile&apos;, function(data){
            //callback operations
        });

        socket.on(&apos;processToIntegrate&apos;, function(data){
            //callback operations
        });
    });

});

</code>
</code></pre>
<p>An example web-based agent can be found in: <code>Sbgnviz-Collaborative-Editor/agent-interaction/computerAgent.html</code></p>
<p>You can zoom and pan with the mouse wheel and left click + moving the mouse</p>
<p>Command History:</p>
<p>JSON array as:</p>
<pre><code><code class="source-code prettyprint">[
    {
    userName: //name of the user who gave the command
    name: //name of the command
    id: //id of the affected element
    param: //operation parameters
    [
        {
        x: //node position x
        y: //node position y
        class: //node or edge sbgnclass
        source: //edge source
        target: //edge target
        }
    ]
    date: //date of the command
    }
]</code>
</code></pre><h2 id="history-manager">History Manager</h2><p>Each command is stored in the model as a part of command history.
Command structure is as follows:</p>
<ul>
<li>opName: set | add | delete | init</li>
<li>opTarget: node | edge | node group | edge group</li>
<li>opAttr: id| position | sbgnclass | sbgnlabel | width | height |
backgroundColor | borderColor | borderWidth | parent | isCloneMarker |
isMultimer | sbgnStatesAndInfos| source| target |lineColor | lineWidth|
sbgncardinality</li>
<li>elId: id of the node or edge | id array of the node or edge group</li>
<li>elType: &quot;node&quot; or &quot;edge&quot;</li>
<li>param:</li>
<li>prevParam:</li>
</ul>
<h3 id="json-model-structure">JSON Model Structure</h3><ul>
<li>users<ul>
<li>name</li>
</ul>
</li>
<li><p>page</p>
<ul>
<li>list</li>
<li>room</li>
<li><p>doc</p>
<ul>
<li>userIds</li>
<li>history</li>
<li>undoIndex</li>
<li>Images</li>
<li>Context<ul>
<li>name</li>
<li>relevance</li>
<li>confidence</li>
</ul>
</li>
<li><p>cy //sbgn-related</p>
<ul>
<li>layoutProperties</li>
<li><p>nodes</p>
<ul>
<li>[nodeId]<ul>
<li>addedLater //to sync. node addition</li>
<li>visibilityStatus</li>
<li>highlightStatus</li>
<li>expandCollapseStatus</li>
<li>highlightColor</li>
<li>position</li>
<li>data<ul>
<li>id</li>
<li>class</li>
<li>label</li>
<li>bbox<ul>
<li>w</li>
<li>h</li>
</ul>
</li>
<li>border-color</li>
<li>border-width</li>
<li>background-color</li>
<li>background-opacity</li>
<li>font-color</li>
<li>font-weight</li>
<li>font-style</li>
<li>font-size</li>
<li>cloneMarker</li>
<li>parent</li>
<li>ports</li>
<li>statesAndInfos</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>edges</p>
<ul>
<li>[edgeId]<ul>
<li>id</li>
<li>addedLater //to sync. edge addition</li>
<li>highlightStatus</li>
<li>visibilityStatus</li>
<li>expandCollapseStatus</li>
<li>highlightColor</li>
<li>bendPoints</li>
<li>data<ul>
<li>class</li>
<li>source</li>
<li>target</li>
<li>portsource</li>
<li>porttarget</li>
<li>line-color</li>
<li>width</li>
<li>bendPointPositions</li>
<li>cardinality</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>py // pysb-related</li>
<li>//biopax-related</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
